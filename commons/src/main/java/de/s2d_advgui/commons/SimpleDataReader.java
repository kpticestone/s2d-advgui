package de.s2d_advgui.commons;

import java.io.InputStream;

public class SimpleDataReader extends InputStream {
    // -------------------------------------------------------------------------------------------------------------------------
    int offset = 0;
    // -------------------------------------------------------------------------------------------------------------------------
    private byte[] arr;

    // -------------------------------------------------------------------------------------------------------------------------
    public SimpleDataReader(byte[] arr) {
        this.arr = arr;
    }

    // -------------------------------------------------------------------------------------------------------------------------
    @Override
    public int read() {
        return this.arr[this.offset++] & 0xFF;
    }

    // -------------------------------------------------------------------------------------------------------------------------
    public final int readInt() {
        return ((this.read() << 24) + (this.read() << 16) + (this.read() << 8) + (this.read()));
    }

    // -------------------------------------------------------------------------------------------------------------------------
    public String readString(int maxlen) {
        try {
            String back = new String(this.arr, this.offset, maxlen).trim();
            if (back.isEmpty()) return null;
            return back;
        } finally {
            this.offset += maxlen;
        }
    }

    // -------------------------------------------------------------------------------------------------------------------------
    public void skip(int i) {
        this.offset += i;
    }

    // -------------------------------------------------------------------------------------------------------------------------
    public void skipInt() {
        this.offset += 4;
    }

    // -------------------------------------------------------------------------------------------------------------------------
    @Override
    public void close() {
        this.arr = null;
        this.offset = -1;
    }

    // -------------------------------------------------------------------------------------------------------------------------
    public double readDouble() {
        return Double.longBitsToDouble(this.readLong());
    }

    // -------------------------------------------------------------------------------------------------------------------------
    public long readLong() {
        return (((long) this.arr[this.offset++] << 56) + ((long) (this.arr[this.offset++] & 255) << 48)
                + ((long) (this.arr[this.offset++] & 255) << 40) + ((long) (this.arr[this.offset++] & 255) << 32)
                + ((long) (this.arr[this.offset++] & 255) << 24) + ((this.arr[this.offset++] & 255) << 16)
                + ((this.arr[this.offset++] & 255) << 8) + ((this.arr[this.offset++] & 255)));
    }

    // -------------------------------------------------------------------------------------------------------------------------
    public float readFloat() {
        return Float.intBitsToFloat(this.readInt());
    }

    // -------------------------------------------------------------------------------------------------------------------------
    public boolean isEmpty() {
        return this.offset >= this.arr.length;
    }

    // -------------------------------------------------------------------------------------------------------------------------
    public boolean readBoolean() {
        return this.read() == 1;
    }

    // -------------------------------------------------------------------------------------------------------------------------
}
